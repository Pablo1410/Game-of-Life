<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juego de la Vida - 10x10</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-family: sans-serif;
            background-color: #f0f0f0;
            margin-top: 50px;
        }

        /* Contenedor de la cuadrícula */
        #tablero {
            display: grid;
            /* 10 columnas de 40px */
            grid-template-columns: repeat(10, 40px);
            /* 10 filas de 40px */
            grid-template-rows: repeat(10, 40px);
            gap: 1px;
            background-color: #ccc;
            border: 2px solid #333;
        }

        /* Estilo de las celdas */
        .celda {
            width: 40px;
            height: 40px;
            background-color: white;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .celda:hover {
            background-color: #e0e0e0;
        }

        /* Estado vivo */
        .viva {
            background-color: #2c3e50;
        }

        /* Controles */
        .controles {
            margin-top: 20px;
            display: flex;
            gap: 10px;
        }

        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            border: none;
            border-radius: 4px;
            color: white;
            font-weight: bold;
        }

        #btn-run { background-color: #3db01b; }
        #btn-reset { background-color: #e74c3c; }
        
        p { color: #666; font-size: 14px; }
    </style>
</head>
<body>

    <h1>Game of life</h1>

    <div id="tablero"></div>

    <div class="controles">
        <button id="btn-run">Correr Simulación</button>
        <button id="btn-reset">Limpiar Tablero</button>
    </div>

    <script>
        const tableroHTML = document.getElementById('tablero');
        const btnRun = document.getElementById('btn-run');
        const btnReset = document.getElementById('btn-reset');
        
        const filas = 10;
        const columnas = 10;
        let celdas = []; // Array plano para manipular el DOM
        let intervalo = null;

        // --- 1. INICIALIZACIÓN ---
        for (let i = 0; i < filas * columnas; i++) {
            const div = document.createElement('div');
            div.classList.add('celda');
            div.addEventListener('click', () => div.classList.toggle('viva'));
            tableroHTML.appendChild(div);
            celdas.push(div);
        }

        // --- 2. LÓGICA DE DATOS ---
        // Convierte el estado de los DIVs a una matriz numérica (0 y 1)
        function obtenerMapa() {
            let mapa = [];
            for (let f = 0; f < filas; f++) {
                let filaActual = [];
                for (let c = 0; c < columnas; c++) {
                    const index = f * columnas + c;
                    filaActual.push(celdas[index].classList.contains('viva') ? 1 : 0);
                }
                mapa.push(filaActual);
            }
            return mapa;
        }

        // --- 3. MOTOR DE REGLAS ---
        function siguienteGeneracion() {
            const mapaActual = obtenerMapa();
            const nuevoMapa = [];

            for (let f = 0; f < filas; f++) {
                nuevoMapa[f] = [];
                for (let c = 0; c < columnas; c++) {
                    let vecinosVivos = 0;

                    // Contar 8 vecinos
                    for (let i = -1; i <= 1; i++) {
                        for (let j = -1; j <= 1; j++) {
                            if (i === 0 && j === 0) continue; // No contarse a sí misma

                            // Lógica Toroide (bordes conectados)
                            let filaV = (f + i + filas) % filas;
                            let colV = (c + j + columnas) % columnas;
                            
                            vecinosVivos += mapaActual[filaV][colV];
                        }
                    }

                    // Aplicar Reglas de Conway
                    const estaViva = mapaActual[f][c] === 1;
                    if (estaViva && (vecinosVivos === 2 || vecinosVivos === 3)) {
                        nuevoMapa[f][c] = 1; // Sobrevive
                    } else if (!estaViva && vecinosVivos === 3) {
                        nuevoMapa[f][c] = 1; // Nace
                    } else {
                        nuevoMapa[f][c] = 0; // Muere
                    }
                }
            }
            actualizarPantalla(nuevoMapa);
        }

        // --- 4. RENDERIZADO ---
        function actualizarPantalla(mapa) {
            for (let f = 0; f < filas; f++) {
                for (let c = 0; c < columnas; c++) {
                    const index = f * columnas + c;
                    if (mapa[f][c] === 1) {
                        celdas[index].classList.add('viva');
                    } else {
                        celdas[index].classList.remove('viva');
                    }
                }
            }
        }

        // --- 5. EVENTOS ---
        btnRun.addEventListener('click', () => {
            if (intervalo) {
                clearInterval(intervalo);
                intervalo = null;
                btnRun.innerText = "Correr Simulación";
                btnRun.style.backgroundColor = "#3db01b";
            } else {
                intervalo = setInterval(siguienteGeneracion, 200);
                btnRun.innerText = "Detener";
                btnRun.style.backgroundColor = "#f39c12";
            }
        });

        btnReset.addEventListener('click', () => {
            if (intervalo) {
                clearInterval(intervalo);
                intervalo = null;
                btnRun.innerText = "Correr Simulación";
                btnRun.style.backgroundColor = "#3db01b";
            }
            celdas.forEach(c => c.classList.remove('viva'));
        });

    </script>
</body>
</html>